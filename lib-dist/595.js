"use strict";(self.webpackChunkSDK=self.webpackChunkSDK||[]).push([[595],{13:(e,t,a)=>{function r(e){const t=Object.keys(e);return 1===t.length?t[0]:void 0}a.d(t,{m:()=>r})},973:(e,t,a)=>{a.d(t,{Z:()=>r});class r{_sdkName="";constructor(e){this._sdkName=e}get name(){return this._sdkName}get deviceInfo(){return{type:"desktop",isDesktop:()=>!0,isMobile:()=>!1,isTablet:()=>!1,isTV:()=>!1}}async getPlayerData(e){const t=JSON.parse(function(e){try{return localStorage.getItem("DATA")}catch{return null}}()??"{}");if(void 0===e)return t;const a={};for(const r of e)a[r]=t[r];return a}async setPlayerData(e){!function(e,t){try{localStorage.setItem("DATA",t)}catch{return}}(0,JSON.stringify(e))}log(...e){console.log(`%c[${this._sdkName}]:`,"background: wheat; color: #1E324B; font-family: tahoma, verdana, helvetica, arial; font-size: 14px; font-weight: 900; text-align: center; padding: 6px 2px; border-radius: 6px; border: 2px solid #434975",...e)}}},595:(e,t,a)=>{a.r(t),a.d(t,{default:()=>d});var r=a(602),s=a(13),n=a(983),i=a(973);class d extends i.Z{_adErrorReceived=new r.FK;_adStartedReceived=new r.FK;_adCompletedReceived=new r.FK;_gamePauseReceived=new r.FK;_gameStartReceived=new r.FK;_rewardedRewardReceived=new r.FK;_isDraft;_sdk=null;_player=null;_yplayer=null;_payments=null;_leaderboards=null;_isAuthorized=!1;constructor(){super((0,s.m)({YandexGamesSDKWrapper:d})),this._isDraft=location.hash.search("draft=true")>=0}get contentPauseRequested(){return this._gamePauseReceived.asEvent()}get contentContinueRequested(){return this._gameStartReceived.asEvent()}get adOpened(){return this._adStartedReceived.asEvent()}get adClosed(){return this._adCompletedReceived.asEvent()}get rewardedRewardReceived(){return this._rewardedRewardReceived.asEvent()}get canShowAdOnLoading(){return!0}get locale(){let e=n.g.Russian;switch(this.lang){case"ru":case"be":case"kk":case"uk":case"uz":e=n.g.Russian;break;case"tr":e=n.g.Turkish;break;case"de":e=n.g.Deutsch;break;default:e=n.g.English}return e}get lang(){return this._sdk.environment.i18n.lang}get tld(){return this._sdk.environment.i18n.tld}get id(){return this._sdk.environment.app.id}get deviceInfo(){return this._sdk.deviceInfo}get environment(){return this._sdk.environment}get isAuthorized(){return this._isAuthorized}get isDraft(){return this._isDraft}async initialize(){!function(e,t,a,r,s,n,i){e[s]=e[s]||function(...t){(e[s].a=e[s].a||[]).push(t)},e[s].l=(new Date).getTime();for(let e=0;e<document.scripts.length;e++)if(document.scripts[e].src===r)return;n=t.createElement(a),i=t.getElementsByTagName(a)[0],n.async=1,n.src=r,i.parentNode.insertBefore(n,i)}(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym"),window.ym(window.yandexMetricaCounterId,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0}),window.ym(window.yandexMetricaCounterId,"reachGoal","pageOpen");const e=()=>{const e=performance.getEntriesByType("navigation")[0],t=e.domContentLoadedEventStart-e.startTime;window.ym(window.yandexMetricaCounterId,"reachGoal","pageLoad",{pageLoadTime:t/1e3})};"loading"!==document.readyState?e():window.addEventListener("DOMContentLoaded",e);const t=document.createElement("script");t.src="https://yandex.ru/games/sdk/v2",document.head.appendChild(t),await new Promise((e=>{t.addEventListener("load",(()=>{window.YaGames.init().then((async t=>{this._sdk=t,e()}))}))})),await this.getPlayer()}ready(){this._sdk.features.LoadingAPI?.ready()}gameplayStart(){this.log("Gameplay Start")}gameplayStop(){this.log("Gameplay Stop")}happyTime(){this.log("Happy Time")}async isMe(e){return this.getPlayer().then((t=>t.uuid==e)).catch((()=>!1))}async authorizePlayer(){return this._sdk.auth.openAuthDialog().then((async()=>{this._yplayer=null,await this.getPlayerInternal()}))}async getPlayer(){return null!==this._player?this._player:this.getPlayerInternal().then((e=>(this._player={get isAuthorized(){return"lite"!==e.getMode()},get hasNamePermission(){return"allow"==e._personalInfo.scopePermissions.public_name},get hasPhotoPermission(){return"allow"==e._personalInfo.scopePermissions.avatar},get name(){return e.getName()},get photo(){return{small:e.getPhoto("small"),medium:e.getPhoto("medium"),large:e.getPhoto("large")}},get uuid(){return e.getUniqueID()}},this._player))).catch((()=>(this._player={get isAuthorized(){return!1},get hasNamePermission(){return!1},get hasPhotoPermission(){return!1},get name(){return""},get photo(){return{small:"",medium:"",large:""}},get uuid(){return""}},this._player)))}sendAnalyticsEvent(e,t){window.ym(window.yandexMetricaCounterId,"reachGoal",e,t)}showInterstitial(){this._gamePauseReceived.dispatch(),this._sdk.adv.showFullscreenAdv({callbacks:{onOpen:()=>{this._adStartedReceived.dispatch()},onClose:e=>{this._adCompletedReceived.dispatch(e),this._gameStartReceived.dispatch()},onError:e=>{this._adErrorReceived.dispatch(e)}}})}showRewarded(){this._gamePauseReceived.dispatch(),this._sdk.adv.showRewardedVideo({callbacks:{onOpen:()=>{this._adStartedReceived.dispatch()},onRewarded:()=>{this._rewardedRewardReceived.dispatch()},onClose:e=>{this._adCompletedReceived.dispatch(e),this._gameStartReceived.dispatch()},onError:e=>{this._adErrorReceived.dispatch(e)}}})}async canReview(){return this._sdk.feedback.canReview()}async requestReview(){return this._sdk.feedback.requestReview()}async getPlayerInternal(){return null!==this._yplayer?this._yplayer:this._sdk.getPlayer({scopes:!1}).then((e=>(this._isAuthorized="lite"!==e.getMode(),this._yplayer=e,e)))}async getPayments(){return null!==this._payments?this._payments:this._sdk.getPayments().then((e=>(this._payments=e,e)))}async getLeaderboards(){return this._isAuthorized?null!==this._leaderboards?this._leaderboards:this._sdk.getLeaderboards().then((e=>(this._leaderboards=e,e))):Promise.reject()}async getPurchasedProducts(){return this.getPayments().then((e=>e.getPurchases()))}overrideProductsCatalog(){}async getProductCatalog(){return this.getPayments().then((async e=>(await e.getCatalog()).map((e=>({id:e.id,imageURI:e.imageURI,currencyImageURI:e.getPriceCurrencyImage("medium"),svgCurrencyImageURI:e.getPriceCurrencyImage("svg"),meta:{en:{name:e.title,description:e.description},ru:{name:e.title,description:e.description}},prices:{YAN:parseFloat(e.priceValue)}})))))}async purchaseProduct(e,t){return this.getPayments().then((a=>a.purchase({id:e,developerPayload:t})))}async consumeProduct(e){return this.getPayments().then((t=>t.consumePurchase(e)))}async setLeaderboardScore(e,t,a){return this.getLeaderboards().then((r=>r.setLeaderboardScore(e,t,a)))}async getLeaderboardEntries(e,t,a,r){return this.getLeaderboards().then((async s=>{const n=await s.getLeaderboardEntries(e,{includeUser:r,quantityAround:a,quantityTop:t});return{...n,entries:n.entries.map((e=>({...e,player:{...e.player,isAuthorized:"not_set"!=e.player.scopePermissions.avatar,hasNamePermission:"allow"==e.player.scopePermissions.public_name,hasPhotoPermission:"allow"==e.player.scopePermissions.avatar,name:e.player.publicName,photo:{small:e.player.getAvatarSrc("small"),medium:e.player.getAvatarSrc("medium"),large:e.player.getAvatarSrc("large")},uuid:e.player.uniqueID}})))}}))}async getFlags(e){return this._sdk.getFlags(e)}async getPlayerData(e=void 0){return this.getPlayerInternal().then((t=>t.getData(e))).catch((()=>super.getPlayerData(e)))}async setPlayerData(e){return this.getPlayerInternal().then((t=>t.setData(e))).finally((()=>super.setPlayerData(e)))}}}}]);